/* Auto-generated by AutoZig - Do not edit */

/**
 * Load WASM module from URL
 * @param {string} path - Path to .wasm file
 * @returns {Promise<AutoZigWasm>}
 */
export async function loadWasm(path) {
  const response = await fetch(path);
  const buffer = await response.arrayBuffer();
  return loadWasmSync(buffer);
}

/**
 * Load WASM module from ArrayBuffer
 * @param {ArrayBuffer} buffer
 * @returns {Promise<AutoZigWasm>}
 */
export async function loadWasmSync(buffer) {
  const result = await WebAssembly.instantiate(buffer, {});
  const instance = result.instance;
  const raw = instance.exports;

  return {
    exports: wrapExports(raw),
    memory: raw.memory,
    instance: instance
  };
}

/**
 * Wrap raw WASM exports with type conversions
 * @param {object} raw - Raw WebAssembly exports
 * @returns {WasmExports}
 */
function wrapExports(raw) {
  return {
    add: raw.add,
    multiply: raw.multiply,
    get_version: raw.get_version,
    square: raw.square,
    is_even: (n) => !!raw.is_even(n)
  };
}
